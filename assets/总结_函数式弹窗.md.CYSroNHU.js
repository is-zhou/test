import{_ as i,c as a,o as n,af as h}from"./chunks/framework.W5ZyBR1w.js";const o=JSON.parse('{"title":"å‡½æ•°å¼å¼¹çª—","description":"","frontmatter":{},"headers":[],"relativePath":"æ€»ç»“/å‡½æ•°å¼å¼¹çª—.md","filePath":"æ€»ç»“/å‡½æ•°å¼å¼¹çª—.md"}'),k={name:"æ€»ç»“/å‡½æ•°å¼å¼¹çª—.md"};function p(l,s,t,e,d,E){return n(),a("div",null,[...s[0]||(s[0]=[h(`<h1 id="å‡½æ•°å¼å¼¹çª—" tabindex="-1">å‡½æ•°å¼å¼¹çª— <a class="header-anchor" href="#å‡½æ•°å¼å¼¹çª—" aria-label="Permalink to â€œå‡½æ•°å¼å¼¹çª—â€">â€‹</a></h1><p>æŠ€æœ¯æ ˆï¼š Vue3 + TS</p><h2 id="_1ã€é€šè¿‡-sfc-å•æ–‡ä»¶ç»„ä»¶å½¢å¼å†™å¥½å¼¹çª—" tabindex="-1">1ã€é€šè¿‡ SFC å•æ–‡ä»¶ç»„ä»¶å½¢å¼å†™å¥½å¼¹çª— <a class="header-anchor" href="#_1ã€é€šè¿‡-sfc-å•æ–‡ä»¶ç»„ä»¶å½¢å¼å†™å¥½å¼¹çª—" aria-label="Permalink to â€œ1ã€é€šè¿‡ SFC å•æ–‡ä»¶ç»„ä»¶å½¢å¼å†™å¥½å¼¹çª—â€">â€‹</a></h2><p>å…³é”®ç‚¹æ˜¯å£°æ˜ <code>emits</code>å’Œ<code>props</code>ï¼›è¿™ä¸¤ä¸ªå€¼åé¢ä¼šç”¨ä½œè°ƒç”¨å‡½æ•°çš„å‚æ•°ç±»å‹æ¨å¯¼ï¼Œ<code>props</code>æ˜¯å‡½æ•°å‚æ•°ï¼Œ<code>emits</code>çš„ reject æ¨å¯¼ä¸ºè¿”å›å€¼ç±»å‹</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//è°ƒç”¨å¼¹çª—çš„è¿”å›å€¼ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IEmits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;close&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">isClose</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;resolve&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;reject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//è°ƒç”¨å¼¹çª—çš„å‚æ•°ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  htmlMsg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> emits</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineEmits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IEmits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> props</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleConfirm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  emits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;close&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;resolve&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleCancel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  emits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;close&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;reject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;scss&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> scoped</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="_2ã€å¯¼å‡ºå¼¹çª—ç»„ä»¶" tabindex="-1">2ã€å¯¼å‡ºå¼¹çª—ç»„ä»¶ <a class="header-anchor" href="#_2ã€å¯¼å‡ºå¼¹çª—ç»„ä»¶" aria-label="Permalink to â€œ2ã€å¯¼å‡ºå¼¹çª—ç»„ä»¶â€">â€‹</a></h2><p>ä½¿ç”¨ <code>defineAsyncComponent</code> å¼‚æ­¥å¯¼å‡ºï¼Œè¿™æ ·æ‰“åŒ…æ—¶æ¯ä¸ªå¼¹çª—ç»„ä»¶ä¼šå½¢æˆä¸€ä¸ªå•ç‹¬çš„ chunk æ¨¡å—ï¼Œåœ¨çœŸæ­£è°ƒç”¨çš„æ—¶å€™æ‰ä¼šåŠ è½½å¯¹åº”çš„ç»„ä»¶ï¼ˆæ˜¯å¦ç®—é¡¹ç›®ä¼˜åŒ–ï¼Ÿï¼‰</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineAsyncComponent } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> dialogComponent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  DialogInfo: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">defineAsyncComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./DialogInfo.vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  DialogSuccess: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">defineAsyncComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./DialogSuccess.vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dialogComponent;</span></span></code></pre></div><h2 id="_3ã€å¼¹çª—çš„-ts-ç±»å‹æ¨å¯¼" tabindex="-1">3ã€å¼¹çª—çš„ TS ç±»å‹æ¨å¯¼ <a class="header-anchor" href="#_3ã€å¼¹çª—çš„-ts-ç±»å‹æ¨å¯¼" aria-label="Permalink to â€œ3ã€å¼¹çª—çš„ TS ç±»å‹æ¨å¯¼â€">â€‹</a></h2><p>é€šè¿‡<code>keyof typeof</code> å°†ä¸Šé¢å¯¼å‡ºçš„<code>dialogComponent</code>æ‰€æœ‰ç»„ä»¶çš„ç­–ç•¥å¯¹è±¡ key è½¬æ¢ä¸ºè”åˆç±»å‹ <code>export type ModalName = keyof typeof modals;</code></p><p>è¿™æ ·å°±è·å¾—äº†æ‰€æœ‰å£°æ˜çš„å¼¹çª—ç»„ä»¶çš„åç§°è”åˆç±»å‹äº†<code>type ModalName = &quot;DialogInfo&quot; | &quot;DialogSuccess&quot;</code></p><p>é€šè¿‡ <code>in</code> å…³é”®å­—åšç±»å‹çš„æ˜ å°„ï¼Œå³å¯ä»¥é™åˆ¶ ModalsProps å’Œ ModalsResult ç±»å‹çš„ key çš„å€¼ã€‚</p><h3 id="modalsprops" tabindex="-1">ModalsProps <a class="header-anchor" href="#modalsprops" aria-label="Permalink to â€œModalsPropsâ€">â€‹</a></h3><p><code>InstanceType&lt;(typeof modals)[K]&gt;</code><code>InstanceType&lt;T&gt;</code>ï¼šå¦‚æœ T æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ç±»å‹ï¼Œ<code>InstanceType&lt;T&gt;</code> ä¼šå¾—åˆ°å…¶å®ä¾‹ç±»å‹ã€‚å¯¹äº Vue ç»„ä»¶ï¼Œè¿™èƒ½å¾—åˆ°ç»„ä»¶å®ä¾‹ç±»å‹ï¼ˆç»„ä»¶å®ä¾‹é€šå¸¸åŒ…å« <code>$props</code>ã€<code>$emit</code>ã€<code>$el</code> ç­‰æˆå‘˜ï¼‰ã€‚</p><p><code>extends { $props: infer P } ? ... : never</code> è¿™æ˜¯ä¸€ä¸ªæ¡ä»¶ç±»å‹ï¼šå¦‚æœè¯¥å®ä¾‹ç±»å‹æœ‰ <code>$props</code> å±æ€§ï¼Œå°±æŠŠ <code>$props</code> çš„ç±»å‹æ¨æ–­å‡ºæ¥<code>ï¼ˆinfer Pï¼‰</code>ï¼›å¦åˆ™ç»“æœæ˜¯ <code>never</code>ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¾èµ–ç»„ä»¶å®ä¾‹ä¸Šå­˜åœ¨ <code>$props</code> æ¥è·å¾—è¯¥ç»„ä»¶çš„ <code>props</code> ç±»å‹</p><p><code>Omit&lt;P, keyof VNodeProps | keyof AllowedComponentProps | &quot;onClose&quot;&gt;</code> æŠŠæ¨æ–­å‡ºæ¥çš„ Pï¼ˆç»„ä»¶ propsï¼‰ä¸­æ’é™¤ä¸‰ä¸ªé›†åˆçš„ keysï¼š</p><p><code>keyof VNodeProps</code>ï¼šVue çš„ VNode é€šç”¨ propsï¼ˆå¦‚ keyã€ref ç­‰ï¼‰</p><p><code>keyof AllowedComponentProps</code>ï¼šVue å…è®¸çš„ç»„ä»¶é€šç”¨ prop</p><p>å­—é¢ <code>&quot;onClose&quot;</code>ï¼šæ˜¾å¼æ’é™¤ onClose propï¼ˆé€šå¸¸æ˜¯å› ä¸ºæ¨¡æ€æ¡†çš„å…³é—­ä¸å¸Œæœ›ç”¨æˆ·ç›´æ¥é€šè¿‡ prop ä¼ é€’ï¼Œæˆ–åœ¨å¤–éƒ¨æ§åˆ¶æ—¶ç”¨äº‹ä»¶è€Œé propï¼‰ è¿™æ ·å¾—åˆ°çš„å°±æ˜¯â€œæˆ‘ä»¬å…³å¿ƒçš„ã€ä¸”ä¸æ˜¯ Vue é€šç”¨é¡¹ä¸”ä¸æ˜¯ onClose çš„ä¸šåŠ¡ propsâ€ã€‚</p><p><code>-readonly [V in keyof ...]: P[V];</code> è¿™æ˜¯ TypeScript çš„æ˜ å°„ä¿®é¥°ç¬¦ï¼š-readonly ä¼šå»æ‰åŸæ¥ props ä¸Šçš„ readonly ä¿®é¥°ç¬¦ï¼ˆå¦‚æœ P ä¸­æŸäº›å±æ€§æ˜¯ readonlyï¼Œæ˜ å°„åä¼šå˜æˆå¯å†™ï¼‰ã€‚ æœ€ç»ˆç»“æœæ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œå±æ€§ä¸ Pï¼ˆå»é™¤é‚£äº›ä¸æƒ³è¦çš„é”®ï¼‰ç›¸åŒï¼Œä¸”å±æ€§å¯å†™ï¼Œå¹¶ä¸”ç±»å‹ä¸ºåŸæ¥ P[V]ã€‚</p><h3 id="modalsresult" tabindex="-1">ModalsResult <a class="header-anchor" href="#modalsresult" aria-label="Permalink to â€œModalsResultâ€">â€‹</a></h3><p>è¿™ä¸ªç±»å‹å®šä¹‰åœ¨åšå¦ä¸€ä»¶äº‹ï¼šä¸ºæ¯ä¸ª modal æ¨æ–­å‡ºå½“æ¨¡æ€æ¡†è§¦å‘ close äº‹ä»¶æ—¶ï¼Œclose äº‹ä»¶æºå¸¦çš„ç»“æœç±»å‹ï¼ˆå³å¤–éƒ¨å…³å¿ƒçš„â€œæ¨¡æ€æ¡†è¿”å›å€¼â€ç±»å‹ï¼‰ã€‚é€æ­¥æ‹†è§£ï¼š</p><p>å¤–å±‚åŒæ ·æ˜¯æ˜ å°„ï¼š<code>[K in ModalName]</code>ã€‚</p><p><code>InstanceType&lt;(typeof modals)[K]&gt; extends { $emit: infer P }</code> è¯•å›¾ä»ç»„ä»¶å®ä¾‹ç±»å‹ä¸Šæ¨æ–­ $emit çš„ç±»å‹ï¼ˆVue ç»„ä»¶å®ä¾‹é€šå¸¸æœ‰ $emit æ–¹æ³•ï¼Œç”¨æ¥è§¦å‘äº‹ä»¶ï¼‰ã€‚å¦‚æœå­˜åœ¨ $emitï¼Œå°±æŠŠå®ƒçš„å‡½æ•°ç±»å‹ç”¨ infer P å–å‡ºæ¥ã€‚</p><p><code>P extends (event: infer E, ...args: infer A) =&gt; void</code> å‡è®¾ $emit çš„ç±»å‹æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº‹ä»¶å Eï¼ˆå­—ç¬¦ä¸²å­—é¢é‡é€šå¸¸ï¼‰ï¼Œå…¶ä½™å‚æ•°æ˜¯ ...argsï¼ˆç»„æˆä¸€ä¸ªå…ƒç»„ Aï¼‰ã€‚é€šè¿‡ infer E å’Œ infer A ä» $emit ç±»å‹ä¸­æ¨æ–­äº‹ä»¶åä¸å‚æ•°å…ƒç»„ã€‚</p><p>æ³¨æ„ï¼šè¿™æ˜¯ä¾èµ–äº $emit è¢«å£°æ˜ä¸ºç±»ä¼¼ (event: &#39;close&#39; | &#39;ok&#39;, ...args: [any, ...]) =&gt; void çš„ç­¾åï¼Œè¿™æ · TypeScript æ‰èƒ½æŠŠ E æ¨æ–­ä¸ºå…·ä½“å­—é¢é‡ã€‚</p><p><code>? E extends &quot;close&quot; ? A[1] : never</code> æ£€æŸ¥æ¨æ–­å‡ºçš„ E æ˜¯å¦åŒ…å« &quot;close&quot;ã€‚å¦‚æœåŒ…å« &quot;close&quot;ï¼Œå°±è¿”å› A[1]ï¼ˆæ³¨æ„æ˜¯å…ƒç»„ A çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼‰ï¼›å¦åˆ™è¿”å› neverã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼šå¯¹ close äº‹ä»¶ï¼Œç±»å‹ç³»ç»Ÿå– $emit çš„å‚æ•°å…ƒç»„çš„ç¬¬äºŒé¡¹ä½œä¸ºè¯¥ modal çš„â€œç»“æœç±»å‹â€ã€‚</p><p>å…¶ä½™ : never åˆ†æ”¯åŒå‰ï¼šå¦‚æœæ— æ³•æ¨æ–­åˆ° $emit æˆ–å…¶å½¢çŠ¶ä¸ç¬¦åˆé¢„æœŸï¼Œåˆ™è¯¥ modal çš„ç»“æœç±»å‹ä¸º neverã€‚</p><p>ä¸ºä»€ä¹ˆæ˜¯ A[1]ï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰ï¼Ÿ</p><p>P æ˜¯ $emit çš„ç±»å‹ï¼Œå½¢å¦‚ (event, ...args) =&gt; voidã€‚A è¡¨ç¤º ...args è¿™ä¸€æ®µçš„å…ƒç»„ç±»å‹ã€‚é€šå¸¸ä¹ æƒ¯ä¸Š $emit(&#39;close&#39;, ctx, result) æˆ– $emit(&#39;close&#39;, null, result) è¿™ç§å†™æ³•ä¼šæŠŠç»“æœæ”¾åœ¨ç¬¬äºŒä¸ªä½ç½®ï¼ˆç¬¬ä¸€ä¸ªæ˜¯äº‹ä»¶ç±»å‹æœ¬èº«è¢«å•ç‹¬æ•è·ä¸º Eï¼Œ...args çš„ç¬¬ä¸€ä¸ªå…ƒç´ ç´¢å¼•æ˜¯ 0ï¼Œç¬¬äºŒä¸ªæ˜¯ 1ï¼‰ã€‚</p><p>å› ä¸ºè¿™æ®µä»£ç é€‰æ‹©äº† A[1]ï¼Œå®ƒå‡å®šå‘å‡ºçš„ close äº‹ä»¶çš„å‚æ•°ç»“æ„æ˜¯åƒ ($eventName, something, result) è¿™æ ·ï¼Œæˆ–è€…åœ¨ç±»å‹ä¸Š ...args çš„ç¬¬äºŒé¡¹æ˜¯æˆ‘ä»¬æƒ³è¦çš„â€œè¿”å›æ•°æ®â€ã€‚ï¼ˆå…·ä½“ä¸ºä»€ä¹ˆæ˜¯ [1] è¦çœ‹ä½ ä»¬ç»„ä»¶å®é™…çš„ $emit(&#39;close&#39;, ...) çº¦å®š â€” å¦‚æœä½ ä»¬æ˜¯ $emit(&#39;close&#39;, result)ï¼Œé‚£ä¹ˆè¿™é‡Œåº”ä¸º A[0]ã€‚ï¼‰</p><p>å¦‚æœ $emit çš„å®šä¹‰æ˜¯ä¸åŒçš„ï¼ˆä¾‹å¦‚ $emit(&#39;close&#39;, result)ï¼‰ï¼Œé‚£ä¹ˆ A[1] ä¼šå˜æˆ undefined æˆ– neverï¼Œæ‰€ä»¥è¿™ä¸ªç±»å‹çš„æ­£ç¡®æ€§ä¾èµ–äºç»„ä»¶é‡Œ $emit(&#39;close&#39;, ..., result) çš„å®é™…å‚æ•°çº¦å®šã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// types/modals.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modals </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./components&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { AllowedComponentProps, VNodeProps } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModalName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> keyof</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modals;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModalsProps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">K</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModalName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InstanceType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modals)[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$props</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> infer</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> P</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        -readonly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">V</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> keyof</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Omit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          P</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          keyof</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VNodeProps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> keyof</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AllowedComponentProps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;onClose&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &gt;]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> P</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> never</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModalsResult</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">K</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModalName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InstanceType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modals)[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$emit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> infer</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> P</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ?</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> infer</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> infer</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> A</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      ?</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> E</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;close&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ?</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> A</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> never</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> never</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> never</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h2 id="_3ã€è°ƒç”¨å¼¹çª—çš„å‡½æ•°" tabindex="-1">3ã€è°ƒç”¨å¼¹çª—çš„å‡½æ•° <a class="header-anchor" href="#_3ã€è°ƒç”¨å¼¹çª—çš„å‡½æ•°" aria-label="Permalink to â€œ3ã€è°ƒç”¨å¼¹çª—çš„å‡½æ•°â€">â€‹</a></h2><p><code>createVNode(component, props)</code>ï¼šåˆ›å»ºè™šæ‹ŸèŠ‚ç‚¹ã€‚</p><p><code>render(vnode, container)</code>ï¼šå°†è™šæ‹ŸèŠ‚ç‚¹æ¸²æŸ“åˆ°çœŸå® DOM ä¸­ã€‚</p><p><code>dialogComponent</code> æ‰€æœ‰ç»„ä»¶ç­–ç•¥å¯¹è±¡ <code>ModalsProps / ModalsResult</code>ï¼šä½ å‰é¢å®šä¹‰çš„ç±»å‹æ˜ å°„è¡¨ï¼Œç”¨äºçº¦æŸæ¯ä¸ªç»„ä»¶çš„ props ä¸è¿”å›å€¼ç±»å‹ã€‚</p><p><code>TComponentName</code>ï¼šæå–ç»„ä»¶åç§°ç±»å‹ï¼ˆ&quot;DialogInfo&quot; | &quot;DialogSuccess&quot;ï¼‰ã€‚</p><p><code>const showCustomDialog = &lt;T extends TComponentName&gt;( componentName: T, props: ModalsProps[T] ): Promise&lt;ModalsResult[T]&gt; =&gt; {</code> å®šä¹‰ä¸€ä¸ªæ³›å‹å‡½æ•° showCustomDialogã€‚T æ˜¯ç»„ä»¶åï¼ˆDialogInfo ç­‰ï¼‰ï¼›props ä¼šè¢«è‡ªåŠ¨æ¨æ–­ä¸ºè¯¥ç»„ä»¶å¯¹åº”çš„ props ç±»å‹ï¼›è¿”å›ä¸€ä¸ª Promise&lt;ModalsResult[T]&gt;ï¼Œè¡¨ç¤ºå…³é—­å¼¹çª—åè¿”å›çš„ç»“æœç±»å‹ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createVNode, render, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> VNode } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dialogComponent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./components/index&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ModalsProps, ModalsResult } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TComponentName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> keyof</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dialogComponent;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> domContainer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLDivElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> showCustomDialog</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TComponentName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  componentName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  props</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModalsProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ModalsResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  vm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> destroyedVm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  domContainer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;div&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domContainer);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> component</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dialogComponent[componentName];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">rej</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createVNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(component, {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">props,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      onClose</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">closeType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;resolve&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;reject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModalsResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (closeType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;resolve&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (closeType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;reject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          rej</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        destroyedVm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vm, domContainer);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;popstate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, destroyedVm, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> destroyedVm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domContainer);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  vm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;popstate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, destroyedVm);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> showCustomDialog;</span></span></code></pre></div><h2 id="ä½œä¸ºéš¾ç‚¹äº®ç‚¹è¡¨å•è¯æœ¯" tabindex="-1">ä½œä¸ºéš¾ç‚¹äº®ç‚¹è¡¨å•è¯æœ¯ <a class="header-anchor" href="#ä½œä¸ºéš¾ç‚¹äº®ç‚¹è¡¨å•è¯æœ¯" aria-label="Permalink to â€œä½œä¸ºéš¾ç‚¹äº®ç‚¹è¡¨å•è¯æœ¯â€">â€‹</a></h2><p>ğŸ’¡ äº®ç‚¹æè¿°ï¼ˆç®€å†ç‰ˆï¼‰</p><p>å°è£…äº†ä¸€ä¸ªç±»å‹å®‰å…¨çš„å…¨å±€å¼¹çª—ç®¡ç†å™¨ï¼Œå®ç°åŠ¨æ€åˆ›å»ºä¸é”€æ¯å¯¹è¯æ¡†ç»„ä»¶çš„æœºåˆ¶ã€‚ åŸºäº createVNode ä¸ render åŠ¨æ€æŒ‚è½½ç»„ä»¶å®ä¾‹ï¼Œé€šè¿‡æ³›å‹è‡ªåŠ¨æ¨å¯¼ç»„ä»¶çš„å…¥å‚ä¸è¿”å›ç»“æœç±»å‹ï¼Œç»Ÿä¸€å¯¹è¯æ¡†è°ƒç”¨æ–¹å¼ï¼ˆå¦‚ showCustomDialog(&#39;DialogInfo&#39;, props)ï¼‰ï¼Œæ”¯æŒå¼‚æ­¥ Promise é£æ ¼ç»“æœå¤„ç†ä¸èµ„æºè‡ªåŠ¨é‡Šæ”¾ã€‚è¯¥è®¾è®¡æœ‰æ•ˆé™ä½äº†é‡å¤å¼¹çª—é€»è¾‘ã€å¢å¼ºäº†å¯ç»´æŠ¤æ€§ä¸ç±»å‹å®‰å…¨æ€§ã€‚</p><p>ğŸ—£ é¢è¯•è®²è¿°ç‰ˆï¼ˆè‡ªç„¶è¡¨è¾¾ï¼‰</p><p>åœ¨é¡¹ç›®ä¸­æˆ‘å°è£…äº†ä¸€ä¸ªé€šç”¨çš„å¼¹çª—è°ƒç”¨æœºåˆ¶ã€‚ æˆ‘ä»¬æœ‰å¾ˆå¤šä¸šåŠ¡å¼¹çª—ï¼Œæ¯ä¸ªéƒ½è¦å•ç‹¬å¼•å…¥å’Œæ‰‹åŠ¨æ§åˆ¶æ˜¾ç¤ºçŠ¶æ€ï¼Œç»´æŠ¤æˆæœ¬å¾ˆé«˜ã€‚ æˆ‘å°±å°è£…äº†ä¸€ä¸ª showCustomDialog æ–¹æ³•ï¼Œé€šè¿‡ç»„ä»¶ååŠ¨æ€åŠ è½½å¯¹åº”å¼¹çª—ç»„ä»¶ï¼Œç”¨ createVNode å’Œ render åŠ¨æ€æŒ‚è½½åˆ° DOMã€‚ è°ƒç”¨æ—¶åƒè¿™æ ·ï¼š</p><p><code>showCustomDialog(&#39;DialogInfo&#39;, { title: &#39;æç¤º&#39; }) .then(res =&gt; { /_ ç”¨æˆ·ç¡®è®¤é€»è¾‘ _/ }) .catch(() =&gt; { /_ ç”¨æˆ·å–æ¶ˆé€»è¾‘ _/ });</code></p><p>æ•´ä¸ªå‡½æ•°è¿”å› Promiseï¼Œæ”¯æŒå¼‚æ­¥ç­‰å¾…å…³é—­ç»“æœã€‚ åŒæ—¶æˆ‘ç»“åˆ TypeScript æ³›å‹ï¼Œè‡ªåŠ¨æ¨å¯¼æ¯ä¸ªå¼¹çª—çš„ props å’Œè¿”å›ç±»å‹ï¼Œç¡®ä¿ç±»å‹å®‰å…¨ã€‚ å¦å¤–æˆ‘è¿˜åšäº†è‡ªåŠ¨é”€æ¯å’Œ popstate ç›‘å¬ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ æ•´ä½“è®©å¼¹çª—é€»è¾‘ä»â€œæ‰‹åŠ¨ç®¡ç†â€å˜æˆäº†â€œå£°æ˜å¼è°ƒç”¨â€ï¼Œæ˜¾è‘—æå‡äº†ä»£ç å¤ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>`,47)])])}const g=i(k,[["render",p]]);export{o as __pageData,g as default};
